<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<body>
		<script>
			// 保存需要重新计算的代码；当属性变化时，在重新执行已经保存过的代码
			let price = 5
			let quantity = 2
			let total = 0
			let target = null
			let storage = []
			// the code we're targeting
			target = () => { total = price * quantity }
			// Save this code inside the target
			function record() {
				storage.push(target)
			}
			// Run this code
			function replay() {
				storage.forEach(run => run())
			}
			record()
			price = 20
			// Run all the code I've saved
			replay()
			console.log(`total:${ total }`)
		</script>
	</body>
</html>
